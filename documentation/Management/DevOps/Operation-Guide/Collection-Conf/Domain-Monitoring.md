# 域名监控
## 监控项说明
域名监控的目的是检测域名的可用性，响应时间等。

其中，外网域名监控，是利用不同地区的cdn节点做探测源，模拟多个不同用户的域名请求，监控域名的状态、响应时间、访问成功率等；而内网域名监控，是在内网环境下，由内网机器探测内网域名的状态。

| 域名监控              | 监控项名称                    | 监控项含义       | 单位 | 说明                                                         |
| --------------------- | ----------------------------- | ---------------- | ---- | ------------------------------------------------------------ |
| 内网域名-http语义监控 | $ {name}.res_time             | 响应时间         | 毫秒 |                                                              |
|                       | $ {name}.status               | 状态             |      | 1表示正常，0表示异常                                         |
|                       | $ {name}.reason               |                  |      | 0表示正常，1表示连接超时，2表示连接拒绝，3表示连接错误，4表示请求内容返回不匹配，5表示http状态码不匹配，6表示发送请求失败，7表示读取对方响应失败 |
|                       | ${name}.http_code             | 状态码所占百分比 | %    | http的状态码，只有完成http协议通信的时候，这个监控项才有,未完成http协议通信时，无法获取响应时间及状态码 |
| 外网域名-http语义监控 | $ {name}.res_time             | 响应时间         | 毫秒 |                                                              |
|                       | ${name} .status.success_ratio | 访问成功率       | %    | 统计所有访问和各运营商访问正常的百分比0-100                  |
|                       | ${name}.http_code.ratio       | 状态码所占百分比 | %    | 统计各状态码和状态码+运营商所占百分比                        |
| 内网域名-tcp语义监控  | $ {name}.res_time             | 响应时间         | 毫秒 |                                                              |
|                       | $ {name}.status               | 状态             |      | 1表示正常，0表示异常                                         |
|                       | $ {name}.reason               |                  |      | 0表示正常，1表示连接超时，2表示连接拒绝，3表示连接错误，4表示请求内容返回不匹配，5表示http状态码不匹配，6表示发送请求失败，7表示读取对方响应失败 |
| 外网域名-tcp语义监控  | $ {name}.res_time             | 响应时间         | 毫秒 |                                                              |
|                       | ${name} .status.success_ratio | 访问成功率       | %    | 统计所有访问和各运营商访问正常的百分比0-100                  |
| 内网域名-端口探活     | $ {name}.res_time             | 响应时间         | 毫秒 |                                                              |
|                       | $ {name}.status               | 状态             |      | 1表示正常，0表示异常                                         |
|                       | $ {name}.reason               |                  |      | 0表示正常，1表示连接超时，2表示连接拒绝，3表示连接错误，4表示请求内容返回不匹配，5表示http状态码不匹配，6表示发送请求失败，7表示读取对方响应失败 |
| 外网域名-端口探活     | $ {name}.res_time             | 响应时间         | 毫秒 |                                                              |
|                       | ${name} .status.success_ratio | 访问成功率       | %    | 统计所有访问和各运营商访问正常的百分比0-100                  |
| 内网域名-ping监控     | $ {name}.res_time             | 响应时间         | 毫秒 |                                                              |
|                       | $ {name}.status               | 状态             |      | 1表示正常，0表示异常                                         |
|                       | $ {name}.drop_rate            | 丢包率百分比     | %    | 各节点丢包率的加权均值 0-1                                   |
| 外网域名-ping监控     | $ {name}.res_time             | 响应时间         | 毫秒 |                                                              |
|                       | ${name} .status.success_ratio | 访问成功率       | %    | 统计所有访问和各运营商访问正常的百分比0-100                  |
|                       | $ {name}.drop_rate            | 丢包率百分比     | %    | 各节点丢包率的加权均值 0-1                                   |



## 操作指南


步骤一：菜单选择【智能监控】-【监控配置】，左侧服务树选择产品线或产品线以下节点，在下图所示的采集配置列表页，点击“新建”。

步骤二：打开如图所示的采集配置新建窗口。其中，

监控类型：选择域名监控

名称：该条采集任务的名称，将作为监控指标的前缀支持字母、数字以及_，且必须以字母开头

**方法**：域名探测方法，可选HTTP语义探测、端口探活、TCP语义探测、ping域名。其中TCP语义探测是使用TCP语义探活、探测端口，检查状态以及返回的内容是否正确。

**网络**：域名探测范围，外网域名监控，是利用不同地区的cdn节点做探测源，模拟多个不同用户的域名请求，监控域名的状态、响应时间、访问成功率等；而内网域名监控，是在内网环境下，由内网机器探测内网域名的状态。

**域名**：选择要监控的域名；注意，**应先在服务树应用节点上绑定域名**（服务树-编辑应用页），才可在选中对应服务树节点时，配置已绑定的域名。

采集周期：选择欲配置的采集周期。

地址：所探测的域名具体地址

请求方式：HTTP请求支持GET、POST、HEAD三种方式

请求头：填写http请求报文头里的字段值对

匹配状态码：要匹配的http状态码。

匹配内容：可填写目标页面的内容，通过匹配结果监控页面状态。

重定向次数：请求允许的最大重定向次数。

![image](https://github.com/jdcloudcom/cn/blob/DevOps-guhezhu1/image/DevOps/Operation-Guide36.jpg)
